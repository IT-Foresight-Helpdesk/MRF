<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Foresight IT ‚Äî Troubleshoot Guide (Pro)</title>
  <meta name="description" content="Operator‚Äëgrade troubleshooting console with fuzzy search, deep links, technician mode, and command palette." />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
  <style>
    :root{
      --brand-a:#08ac9c; --brand-b:#08ac9c; /* single-tone */ --accent:#facc15; --ink:#101010;
      --glass:rgba(255,255,255,.14); --glass-strong:rgba(255,255,255,.22); --muted:rgba(255,255,255,.10);
    }
    html,body{height:100%}
    body{font-family:'Poppins',sans-serif; background:var(--brand-a); min-height:100vh; display:flex; flex-direction:column; color:#fff}
    .glass{backdrop-filter:blur(10px); background:var(--glass)}
    .btn{background:var(--accent); color:#7c5f06; border:none; border-radius:999px; padding:8px 14px; font-weight:600; cursor:pointer; transition:transform .15s ease, box-shadow .15s ease}
    .btn:hover{transform:translateY(-1px); box-shadow:0 8px 18px rgba(0,0,0,.25)}
    .btn:focus{outline:2px solid #fff; outline-offset:2px}
    .btn-muted{background:var(--muted); color:#fff}
    .chip{font-size:.8rem; padding:2px 8px; border-radius:999px; background:rgba(255,255,255,.12); color:#fff}
    details.card{background:var(--glass); border-radius:14px; box-shadow:0 8px 16px rgba(0,0,0,.3); overflow:hidden}
    details.card + details.card{margin-top:16px}
    summary{list-style:none; cursor:pointer; padding:16px 18px; display:flex; gap:14px; align-items:flex-start}
    summary::-webkit-details-marker{display:none}
    .icon{font-size:1.9rem; background:rgba(250,204,21,.14); color:var(--accent); border-radius:50%; padding:12px; flex-shrink:0; box-shadow:0 2px 8px rgba(0,0,0,.07)}
    .title{font-size:1.15rem; font-weight:800; display:flex; gap:10px; align-items:center}
    .title .tags{display:flex; gap:6px; flex-wrap:wrap}
    .panel{padding:0 18px 16px 18px}
    .panel ul{list-style:disc; padding-left:1.25rem; margin-top:.5rem}
    .chev{margin-left:auto; transition:transform .15s ease}
    details[open] .chev{transform:rotate(90deg)}
    kbd{background:rgba(0,0,0,.25); padding:2px 6px; border-radius:5px; font-weight:600}
    nav{background:var(--brand-a)}
    @media (prefers-reduced-motion: reduce){*{transition:none!important;animation:none!important}}
    @media print{nav,#toolbar,.actions,.palette{display:none!important} body,main{background:#fff!important;color:#000!important} .card{background:#fff!important;box-shadow:none!important;border:1px solid #ddd}}
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="px-4 py-3 flex flex-wrap items-center justify-between text-white">
    <a href="#" class="text-lg font-bold">Foresight IT ‚Äî Troubleshoot Console</a>
    <div class="flex gap-3 items-center flex-wrap">
      <span class="chip">Last update: <time id="updated"></time></span>
      <button id="techToggle" class="btn btn-muted" type="button" title="Show advanced steps">Technician Mode: <span id="techState">OFF</span></button>
    </div>
  </nav>

  <main class="max-w-5xl w-full mx-auto flex-1 px-4 py-5">
    <h1 class="text-3xl font-bold mb-4">üõ†Ô∏è Basic Troubleshoot ‚Äî Operator Grade</h1>

    <!-- TOOLBAR -->
    <section id="toolbar" class="glass rounded-xl p-3 mb-4 shadow-lg" role="region" aria-label="Tools">
      <div class="flex flex-col md:flex-row gap-3 md:items-center">
        <div class="flex-1 flex items-center gap-2 bg-white/10 rounded-lg px-3 py-2">
          <span aria-hidden="true">üîé</span>
          <input id="search" type="search" placeholder="Fuzzy search‚Ä¶ (printer, internet, webmail, drive‚Ä¶)" class="bg-transparent outline-none border-none w-full text-white placeholder-white/70" autocomplete="off" />
        </div>
        <div class="flex gap-2">
          <button id="expandAll" class="btn btn-muted" type="button">Expand All</button>
          <button id="collapseAll" class="btn btn-muted" type="button">Collapse All</button>
          <button id="printBtn" class="btn" type="button">Print / Save PDF</button>
          <button id="paletteBtn" class="btn btn-muted" type="button" title="Ctrl/Cmd + K">Command Palette</button>
        </div>
      </div>
      <div class="mt-3 flex flex-wrap gap-2" id="tagRow" aria-label="Quick filters"></div>
    </section>

    <!-- LIST -->
    <section id="list" class="mb-20"></section>

    <!-- COMMAND PALETTE -->
    <div id="palette" class="palette fixed inset-0 hidden items-start justify-center pt-24 bg-black/50">
      <div class="glass w-[min(720px,92vw)] rounded-xl shadow-2xl p-3">
        <div class="flex items-center gap-2 bg-white/10 rounded-lg px-3 py-2">
          <span>‚åò</span>
          <input id="paletteInput" placeholder="Type a command or section‚Ä¶" class="bg-transparent outline-none w-full" />
        </div>
        <ul id="paletteList" class="mt-2 max-h-[60vh] overflow-y-auto divide-y divide-white/10"></ul>
      </div>
    </div>
  </main>

  <footer class="glass text-center py-3 text-white">¬© <span id="year"></span> Foresight IT Department ‚Äî Built for GitHub/Netlify deployment</footer>

<script>
// ============================= DATA (sections) =============================
/** Each section: id, icon, title, tags[], basic[], advanced[], commands[] */
const SECTIONS = [
  {
    id: 'power', icon: 'üñ•Ô∏è', title: 'PC/Laptop Cannot Power On',
    tags: ['hardware','power','laptop','pc','basic'],
    basic: [
      'Ensure the power cable is firmly connected at both ends.',
      'Test the power outlet with a known‚Äëgood device.',
      'For laptops, check battery/charger LED; try a different charger if available.',
      'Hold the power button for 10 seconds, release, then press once to start.',
    ],
    advanced: [
      'Remove non‚Äëessential peripherals (USB hubs, HDMI, docks) and try again.',
      'For desktops, reseat RAM and power connectors (24‚Äëpin ATX, 8‚Äëpin CPU).',
      'Check PSU switch (| / O) and test with a paper‚Äëclip PSU test if trained.',
    ],
    commands: []
  },
  {
    id: 'input', icon: 'üñ±Ô∏è', title: 'Mouse or Keyboard Not Working',
    tags: ['usb','bluetooth','peripheral','basic'],
    basic: [
      'Verify the device is connected (USB) or paired (Bluetooth).',
      'Try another USB port; replace wireless batteries.',
      'Test the device on another PC to exclude hardware failure.'
    ],
    advanced: [
      'Windows: Device Manager ‚Üí Keyboards/Mice ‚Üí Uninstall device ‚Üí Scan for hardware changes.',
      'Update chipset/USB drivers from vendor support site.'
    ],
    commands: []
  },
  {
    id: 'internet', icon: 'üåê', title: 'Internet Connection Issues',
    tags: ['network','wifi','ethernet','dns','basic'],
    basic: [
      'Check the network cable and link‚Äëlight on the NIC/switch port.',
      'Toggle Wi‚ÄëFi (off/on) and reconnect to the correct SSID.',
      'Power‚Äëcycle router/modem (pull power 10s, replug).'
    ],
    advanced: [
      'Run local diagnostics below; if captive portal is detected, open it and authenticate.',
      'Windows (Admin): Reset Winsock and flush DNS, then reboot.'
    ],
    commands: [
      { label:'Flush DNS (CMD)', lang:'cmd', filename:'flushdns.cmd', code:'ipconfig /flushdns\r\n' },
      { label:'Winsock Reset (CMD, reboot req.)', lang:'cmd', filename:'winsock_reset.cmd', code:'netsh winsock reset\r\n' },
      { label:'Quick connectivity test (opens in app)', lang:'js', filename:'', code:'__ACTION__:net_test' },
    ]
  },
  {
    id: 'printer', icon: 'üñ®Ô∏è', title: 'Printer Not Responding',
    tags: ['printer','usb','network','basic'],
    basic: [
      'Ensure the printer is powered on and shows ready (no error lights).',
      'Check USB/Ethernet/Wi‚ÄëFi connection.',
      'Verify paper and toner/ink levels.',
      'Power‚Äëcycle the printer and retry.'
    ],
    advanced: [
      'Print a configuration report from the printer panel to confirm IP address.',
      'Ping the printer IP from the PC; if unreachable, check VLAN/Wi‚ÄëFi isolation.'
    ],
    commands: []
  },
  {
    id: 'spooler', icon: 'üóÇÔ∏è', title: 'Users Unable to Print (Queue Stuck)',
    tags: ['printer','spooler','windows','advanced'],
    basic: [
      'Control Panel ‚Üí Devices and Printers ‚Üí right‚Äëclick printer ‚Üí ‚ÄúSee what‚Äôs printing‚Äù.',
      'Cancel all pending jobs, then try again.'
    ],
    advanced: [
      'Restart the Print Spooler service and clear stuck queue files (Admin required).',
      'Event Viewer ‚Üí Windows Logs ‚Üí System/Application for PrintService errors.'
    ],
    commands: [
      { label:'Restart Spooler (PowerShell, Admin)', lang:'ps1', filename:'restart_spooler.ps1', code:'Stop-Service -Name Spooler -Force; Start-Service -Name Spooler\r\n' },
      { label:'Hard Clear Queue (CMD, Admin)', lang:'cmd', filename:'clear_spooler.cmd', code:'net stop spooler && del /Q /F %systemroot%\\System32\\spool\\PRINTERS\\* && net start spooler\r\n' },
    ]
  },
  {
    id: 'email', icon: 'üìß', title: 'Email Issues',
    tags: ['email','webmail','auth','basic'],
    basic: [
      'Confirm internet access on other sites.',
      'Verify username/password; check Caps Lock.',
      'Try webmail; if works, re‚Äëadd the account in the mail client.',
      'Clear browser cache and cookies if webmail is problematic.'
    ],
    advanced: [
      'Check account lockout/2FA status with the admin panel.',
      'Review SMTP/IMAP/POP server settings and ports; try SSL/TLS variants.'
    ],
    commands: []
  },
  {
    id: 'drive', icon: 'üìÇ', title: 'Shared Network Drive Not Accessible',
    tags: ['drive','smb','permissions','network','advanced'],
    basic: [
      'Verify network connectivity.',
      'Ensure the drive is mapped correctly and credentials are valid.',
      'Try using a UNC path: \\192.168.1.8\\sharedfolder.'
    ],
    advanced: [
      'Check NTFS/Share permissions for the user or group.',
      'Confirm SMB version compatibility and firewall rules.'
    ],
    commands: [
      { label:'Map Drive Z: (CMD)', lang:'cmd', filename:'map_drive_z.cmd', code:'net use Z: \\\192.168.1.8\\sharedfolder /user:DOMAIN\\username *\r\n' },
      { label:'Remove Drive Z: (CMD)', lang:'cmd', filename:'unmap_drive_z.cmd', code:'net use Z: /delete\r\n' }
    ]
  },
  {
    id: 'apps', icon: '‚ö†Ô∏è', title: 'Software/Application Not Opening',
    tags: ['apps','windows','eventviewer','advanced'],
    basic: [
      'Restart the PC and try again.',
      'Repair or reinstall the application.',
      'Check for pending Windows updates and reboot.'
    ],
    advanced: [
      'Event Viewer ‚Üí Windows Logs ‚Üí Application to inspect crash/error events.',
      'Run as Administrator or in compatibility mode when applicable.'
    ],
    commands: []
  },
];

// ============================= UTILITIES =============================
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
const byId = id => document.getElementById(id);
const fmtDate = d => new Date(d).toLocaleDateString();
const ls = window.localStorage;

function slug(s){return s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'')}
function saveFile(filename, content){
  const blob = new Blob([content], {type: 'text/plain;charset=utf-8'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob); a.download = filename; a.click();
  setTimeout(()=>URL.revokeObjectURL(a.href), 1500);
}
function copy(text){return navigator.clipboard.writeText(text)}

// ============================= RENDER =============================
const listEl = byId('list');
function renderList(rows){
  listEl.innerHTML = '';
  rows.forEach(sec => {
    const steps = (items)=> items.map(t=>`<li>${t}</li>`).join('');
    const cmdBtns = sec.commands.map(c=>
      `<button class="btn btn-muted text-sm command-btn" data-id="${sec.id}" data-label="${c.label}" data-lang="${c.lang}" data-filename="${c.filename}" data-code="${encodeURIComponent(c.code)}">${c.label}</button>`
    ).join(' ');

    const html = `
      <details class="card" id="${sec.id}">
        <summary>
          <span class="icon" aria-hidden="true">${sec.icon}</span>
          <div class="title">
            <span>${sec.title}</span>
            <div class="tags">${sec.tags.map(t=>`<span class="chip">#${t}</span>`).join('')}</div>
          </div>
          <span class="chev" aria-hidden="true">‚Ä∫</span>
        </summary>
        <div class="panel">
          <div class="flex flex-wrap gap-2 actions mb-3">
            <button class="btn copy-steps" data-id="${sec.id}">Copy steps</button>
            <button class="btn btn-muted share-steps" data-id="${sec.id}">Share</button>
            <button class="btn btn-muted link-steps" data-id="${sec.id}">Permalink</button>
            ${cmdBtns}
          </div>
          <h3 class="font-bold">Essential</h3>
          <ul>${steps(sec.basic)}</ul>
          <div class="mt-3 tech-block hidden">
            <h4 class="font-bold">Advanced (Technician)</h4>
            <ul>${steps(sec.advanced)}</ul>
          </div>
          ${sec.id==='internet' ? netDiagBlock() : ''}
        </div>
      </details>`;
    listEl.insertAdjacentHTML('beforeend', html);
  });
}

function netDiagBlock(){
  return `<div class="mt-4 glass rounded-lg p-3">
    <div class="flex items-center justify-between gap-2">
      <div class="font-semibold">Network Quick Diagnostics</div>
      <div>
        <button class="btn btn-muted text-sm" data-action="net-test">Run Test</button>
      </div>
    </div>
    <div class="text-sm mt-2 opacity-80">Checks DNS & outbound connectivity via test endpoints.</div>
    <pre class="mt-2 bg-black/30 rounded p-2 overflow-x-auto text-xs" id="netlog">Idle‚Ä¶</pre>
  </div>`
}

// ============================= SEARCH (FUSE) =============================
let fuse;
function initSearch(){
  fuse = new Fuse(SECTIONS, { includeScore:true, threshold:0.36, keys:[ 'title','tags','basic','advanced' ] });
}
function applySearch(term){
  if(!term){ renderList(SECTIONS); restoreTechBlocks(); return }
  const res = fuse.search(term).map(r=>r.item);
  renderList(res); restoreTechBlocks();
}

// ============================= TAG FILTERS =============================
const TAGS = Array.from(new Set(SECTIONS.flatMap(s=>s.tags))).sort();
function renderTags(){
  const row = byId('tagRow'); row.innerHTML = TAGS.map(t=>`<button class="chip hover:bg-white/20" data-tag="${t}">#${t}</button>`).join('');
}
function filterByTag(tag){
  renderList(SECTIONS.filter(s=>s.tags.includes(tag))); restoreTechBlocks();
}

// ============================= TECHNICIAN MODE =============================
function isTech(){ return ls.getItem('fs_tech')==='1' }
function setTech(on){ ls.setItem('fs_tech', on?'1':'0'); byId('techState').textContent = on? 'ON':'OFF'; $$(' .tech-block').forEach(x=>x.classList.toggle('hidden', !on)) }
function restoreTechBlocks(){ $$(' .tech-block').forEach(x=>x.classList.toggle('hidden', !isTech())) }

// ============================= DEEP LINKS =============================
function openFromHash(){
  const id = location.hash.replace('#',''); if(!id) return;
  const el = byId(id); if(!el) return; el.open = true; el.scrollIntoView({behavior:'smooth', block:'start'});
}

// ============================= ACTION HANDLERS =============================
function stepsText(sec){
  const s = SECTIONS.find(x=>x.id===sec); if(!s) return '';
  const mk = arr => arr.map(x=>'‚Ä¢ '+x).join('\n');
  let text = s.title + '\n\n' + mk(s.basic);
  if(isTech() && s.advanced.length){ text += '\n\nAdvanced:\n' + mk(s.advanced) }
  return text;
}

function handleGlobalClicks(e){
  const t = e.target;
  // Copy steps
  if(t.matches('.copy-steps')){
    const id = t.dataset.id; copy(stepsText(id)); flash(t,'Copied');
  }
  // Share
  if(t.matches('.share-steps')){
    const id = t.dataset.id; const text = stepsText(id);
    const title = SECTIONS.find(x=>x.id===id)?.title || 'Troubleshoot Steps';
    if(navigator.share){ navigator.share({title, text}).catch(()=>{}) } else { copy(title+'\n\n'+text); flash(t,'Copied to share') }
  }
  // Permalink
  if(t.matches('.link-steps')){
    const id = t.dataset.id; location.hash = id; copy(location.href); flash(t,'Link copied');
  }
  // Command buttons
  if(t.matches('.command-btn')){
    const code = decodeURIComponent(t.dataset.code || '');
    if(code.startsWith('__ACTION__:net_test')){ runNetTest(); return }
    const fn = t.dataset.filename || 'command.txt';
    saveFile(fn, code.replace(/\\r\\n/g,'\r\n'));
    flash(t,'Saved file');
  }
  // Net test inline button
  if(t.dataset.action==='net-test'){ runNetTest() }
}

function flash(btn, msg){ const prev = btn.textContent; btn.textContent = msg; setTimeout(()=>btn.textContent = prev, 1200) }

async function runNetTest(){
  const pre = byId('netlog'); if(!pre){ alert('Open the Internet section first.'); return }
  const tests = [
    { name:'DNS/HTTP 204', url:'https://www.gstatic.com/generate_204' },
    { name:'Connectivity', url:'https://example.com/' }
  ];
  pre.textContent = 'Running‚Ä¶\n';
  for(const t of tests){
    try{
      const res = await fetch(t.url, { mode:'no-cors' });
      pre.textContent += `${t.name}: request dispatched (no‚ÄëCORS ok)\n`;
    }catch(err){ pre.textContent += `${t.name}: FAIL ‚Äî ${err}\n` }
  }
  pre.textContent += 'Tip: If these fail, check proxy/captive portal/DNS.\n';
}

// ============================= COMMAND PALETTE =============================
const palette = byId('palette');
const paletteInput = byId('paletteInput');
const paletteList = byId('paletteList');
const PA_CMDS = [
  {label:'Expand all', run:()=>$$('details.card').forEach(d=>d.open=true)},
  {label:'Collapse all', run:()=>$$('details.card').forEach(d=>d.open=false)},
  {label:'Toggle Technician Mode', run:()=>{ setTech(!isTech()); restoreTechBlocks(); }},
  {label:'Print / Save PDF', run:()=>window.print()},
  {label:'Open IT Support Form', run:()=>{ location.href='it-support.html' }}
];
function openPalette(){ palette.classList.remove('hidden'); paletteInput.value=''; renderPalette(''); paletteInput.focus() }
function closePalette(){ palette.classList.add('hidden') }
function renderPalette(q){
  const secs = SECTIONS.map(s=>({label:`Open: ${s.title}`, run:()=>{ location.hash='#'+s.id; openFromHash() }}));
  const items = [...PA_CMDS, ...secs];
  const filtered = q? items.filter(i=>i.label.toLowerCase().includes(q.toLowerCase())) : items;
  paletteList.innerHTML = filtered.map((i,idx)=>`<li class="p-2 hover:bg-white/10 cursor-pointer" data-idx="${idx}">${i.label}</li>`).join('');
  paletteList.dataset.map = JSON.stringify(filtered.map((_,i)=>i));
}
paletteList.addEventListener('click', (e)=>{
  const li = e.target.closest('li'); if(!li) return; const idx = +li.dataset.idx;
  const secs = SECTIONS.map(s=>({label:`Open: ${s.title}`, run:()=>{ location.hash='#'+s.id; openFromHash() }}));
  const items = [...PA_CMDS, ...secs]; items[idx]?.run(); closePalette();
})

// ============================= INIT =============================
function init(){
  byId('year').textContent = new Date().getFullYear();
  byId('updated').textContent = new Date().toLocaleDateString();
  initSearch(); renderTags(); renderList(SECTIONS); restoreTechBlocks(); openFromHash();
  // events
  byId('expandAll').addEventListener('click', ()=>$$('details.card').forEach(d=>d.open=true));
  byId('collapseAll').addEventListener('click', ()=>$$('details.card').forEach(d=>d.open=false));
  byId('printBtn').addEventListener('click', ()=>window.print());
  document.body.addEventListener('click', handleGlobalClicks);
  byId('paletteBtn').addEventListener('click', openPalette);
  byId('techToggle').addEventListener('click', ()=>{ setTech(!isTech()); restoreTechBlocks(); });
  // search input
  byId('search').addEventListener('input', (e)=>applySearch(e.target.value));
  // tag filters
  byId('tagRow').addEventListener('click', e=>{ const b=e.target.closest('[data-tag]'); if(b) filterByTag(b.dataset.tag) });
  // keyboard
  window.addEventListener('keydown', (e)=>{
    if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='k'){ e.preventDefault(); openPalette(); }
    if(e.key==='/' && !/input|textarea/i.test(document.activeElement.tagName)){ e.preventDefault(); byId('search').focus(); }
  });
  // restore technician state
  setTech(isTech());
}

window.addEventListener('hashchange', openFromHash);
window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
